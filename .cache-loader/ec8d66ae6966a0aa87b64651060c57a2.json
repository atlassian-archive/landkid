{"remainingRequest":"/Users/lbatchelor/src/landkid/node_modules/ts-loader/index.js??ref--4-1!/Users/lbatchelor/src/landkid/src/static/current-state/components/WithAPIData.tsx","dependencies":[{"path":"/Users/lbatchelor/src/landkid/src/static/current-state/components/WithAPIData.tsx","mtime":1542166670613},{"path":"/Users/lbatchelor/src/landkid/node_modules/cache-loader/dist/cjs.js","mtime":1542164158615},{"path":"/Users/lbatchelor/src/landkid/node_modules/ts-loader/index.js","mtime":1542164158621}],"contextDependencies":[],"result":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst React = require(\"react\");\nconst DEFAULT_POLLING_INTERVAL = 15 * 1000; // 15 sec\nfunction defaultLoading() {\n    return React.createElement(\"div\", null, \"Loading...\");\n}\nclass WithAPIData extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.interval = null;\n        this.state = {\n            error: null,\n            data: null,\n            poll: this.props.poll === true\n                ? DEFAULT_POLLING_INTERVAL\n                : this.props.poll ? this.props.poll : 0,\n        };\n    }\n    fetchData() {\n        fetch(`/api/${this.props.endpoint}`)\n            .then(res => res.json())\n            .then(data => this.setState({ data }))\n            .catch(error => this.setState({ error }));\n    }\n    componentDidMount() {\n        this.fetchData();\n        if (this.state.poll) {\n            this.interval = setInterval(this.fetchData.bind(this), this.state.poll);\n        }\n    }\n    componentWillUnmount() {\n        if (this.interval) {\n            clearInterval(this.interval);\n        }\n    }\n    render() {\n        let { error, data } = this.state;\n        let { renderError, render, renderLoading } = this.props;\n        if (error) {\n            return renderError ? renderError(error) : null;\n        }\n        else if (data) {\n            return render ? render(data) : null;\n        }\n        return renderLoading ? renderLoading() : defaultLoading();\n    }\n}\nexports.WithAPIData = WithAPIData;\n",{"version":3,"file":"/Users/lbatchelor/src/landkid/src/static/current-state/components/WithAPIData.tsx","sourceRoot":"","sources":["/Users/lbatchelor/src/landkid/src/static/current-state/components/WithAPIData.tsx"],"names":[],"mappings":";;AAAA,+BAA+B;AAE/B,MAAM,wBAAwB,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,SAAS;AAErD,SAAS,cAAc;IACrB,OAAO,8CAAqB,CAAC;AAC/B,CAAC;AAgBD,MAAa,WAAY,SAAQ,KAAK,CAAC,SAAuB;IAA9D;;QACE,aAAQ,GAA0B,IAAI,CAAC;QACvC,UAAK,GAAG;YACN,KAAK,EAAE,IAAI;YACX,IAAI,EAAE,IAAI;YACV,IAAI,EACF,IAAI,CAAC,KAAK,CAAC,IAAI,KAAK,IAAI;gBACtB,CAAC,CAAC,wBAAwB;gBAC1B,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;SAC5C,CAAC;IAmCJ,CAAC;IAjCC,SAAS;QACP,KAAK,CAAC,QAAQ,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC;aACjC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,EAAE,CAAC;aACvB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC;aACrC,KAAK,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;IAC9C,CAAC;IAED,iBAAiB;QACf,IAAI,CAAC,SAAS,EAAE,CAAC;QAEjB,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE;YACnB,IAAI,CAAC,QAAQ,GAAG,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;SACzE;IACH,CAAC;IAED,oBAAoB;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;SAC9B;IACH,CAAC;IAED,MAAM;QACJ,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;QACjC,IAAI,EAAE,WAAW,EAAE,MAAM,EAAE,aAAa,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC;QAExD,IAAI,KAAK,EAAE;YACT,OAAO,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SAChD;aAAM,IAAI,IAAI,EAAE;YACf,OAAO,MAAM,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;SACrC;QAED,OAAO,aAAa,CAAC,CAAC,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,cAAc,EAAE,CAAC;IAC5D,CAAC;CACF;AA5CD,kCA4CC","sourcesContent":["import * as React from 'react';\n\nconst DEFAULT_POLLING_INTERVAL = 15 * 1000; // 15 sec\n\nfunction defaultLoading() {\n  return <div>Loading...</div>;\n}\n\nexport type Props = {\n  endpoint: string;\n  poll?: number | boolean;\n  renderError?: (err: Error) => React.ReactNode;\n  renderLoading?: () => React.ReactNode;\n  render?: (data: any) => React.ReactNode;\n};\n\nexport type State = {\n  error: Error | null;\n  data: any;\n  poll: number;\n};\n\nexport class WithAPIData extends React.Component<Props, State> {\n  interval: NodeJS.Timeout | null = null;\n  state = {\n    error: null,\n    data: null,\n    poll:\n      this.props.poll === true\n        ? DEFAULT_POLLING_INTERVAL\n        : this.props.poll ? this.props.poll : 0,\n  };\n\n  fetchData() {\n    fetch(`/api/${this.props.endpoint}`)\n      .then(res => res.json())\n      .then(data => this.setState({ data }))\n      .catch(error => this.setState({ error }));\n  }\n\n  componentDidMount() {\n    this.fetchData();\n\n    if (this.state.poll) {\n      this.interval = setInterval(this.fetchData.bind(this), this.state.poll);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.interval) {\n      clearInterval(this.interval);\n    }\n  }\n\n  render() {\n    let { error, data } = this.state;\n    let { renderError, render, renderLoading } = this.props;\n\n    if (error) {\n      return renderError ? renderError(error) : null;\n    } else if (data) {\n      return render ? render(data) : null;\n    }\n\n    return renderLoading ? renderLoading() : defaultLoading();\n  }\n}\n"]}]}